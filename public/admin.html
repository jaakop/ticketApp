<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Admin page</title>
    <link rel="stylesheet" href="/public/adminstyle.css">
</head>

<body>
    <p>Current queue lenght: <span id="queue"></span></p>
    <h2 id="name"> </h2>
    <button class="button" type="submit" onclick="getNextTicket()">Get the next ticket</button>

    <script>
        GetQueueLenght();
        var updateSpeed = 500;
        document.addEventListener('visibilitychange', function(){
            if(document.hidden)
                updateSpeed = 2000;
            else
                updateSpeed = 500;
        });
        window.onfocus = function(){
            updateSpeed = 500;

        };
        window.onblur = function(){
            updateSpeed = 2000;
        };

        function getNextTicket() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("name").innerHTML = this.responseText;
                }
            };
            xhttp.open("POST", "/admin", true);
            xhttp.send();
        }
        function GetQueueLenght() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("queue").innerHTML = this.responseText;
                }
            };
            xhttp.open("POST", "/admin/getQueLenght", true);
            xhttp.send();
            setTimeout(GetQueueLenght, updateSpeed);
        }
    </script>
</body>

</html>